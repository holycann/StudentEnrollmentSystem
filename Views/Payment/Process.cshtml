@model StudentEnrollmentSystem.Models.ViewModels.PaymentRequestViewModel

@{
    ViewData["Title"] = "Process Payment";
}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="max-w-lg mx-auto">
        <div class="text-center">
            <h1 class="text-3xl font-bold text-gray-900">Payment Details</h1>
            <p class="mt-2 text-sm text-gray-600">
                Complete your payment for @Model.CourseName (@Model.CourseCode)
            </p>
        </div>

        <div class="mt-8">
            <div class="bg-white shadow-lg rounded-lg">
                <div class="px-4 py-5 sm:p-6">
                    <div class="mb-6">
                        <div class="bg-gray-50 px-4 py-5 sm:rounded-lg sm:p-6">
                            <div class="text-center">
                                <h2 class="text-lg font-medium text-gray-900">Amount to Pay</h2>
                                <p class="mt-1 text-4xl font-bold text-primary-600">@Model.Amount.ToString("C")</p>
                            </div>
                        </div>
                    </div>

                    <form asp-action="Process" method="post">
                        <input type="hidden" asp-for="EnrollmentId" />
                        <input type="hidden" asp-for="Amount" />
                        <input type="hidden" asp-for="CourseCode" />
                        <input type="hidden" asp-for="CourseName" />

                        <div asp-validation-summary="ModelOnly" class="mb-4 text-sm text-red-600"></div>

                        <div class="space-y-6">
                            <div>
                                <label asp-for="CardholderName" class="form-label"></label>
                                <input asp-for="CardholderName" class="form-input" placeholder="John Doe" />
                                <span asp-validation-for="CardholderName" class="text-sm text-red-600"></span>
                            </div>

                            <div>
                                <label asp-for="CardNumber" class="form-label"></label>
                                <input asp-for="CardNumber" class="form-input" placeholder="1234 5678 9012 3456" maxlength="16" />
                                <span asp-validation-for="CardNumber" class="text-sm text-red-600"></span>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label asp-for="ExpiryDate" class="form-label"></label>
                                    <input asp-for="ExpiryDate" class="form-input" placeholder="MM/YY" maxlength="5" />
                                    <span asp-validation-for="ExpiryDate" class="text-sm text-red-600"></span>
                                </div>

                                <div>
                                    <label asp-for="CVV" class="form-label"></label>
                                    <input asp-for="CVV" class="form-input" placeholder="123" maxlength="3" />
                                    <span asp-validation-for="CVV" class="text-sm text-red-600"></span>
                                </div>
                            </div>

                            <div class="flex items-center justify-between mt-6">
                                <a asp-controller="Enrollment" asp-action="History" class="btn-secondary">
                                    Cancel
                                </a>
                                <button type="submit" class="btn-primary">
                                    Pay Now
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="mt-6">
                <div class="rounded-md bg-blue-50 p-4">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="ml-3 flex-1 md:flex md:justify-between">
                            <p class="text-sm text-blue-700">
                                This is a dummy payment system. Use any valid-format card details for testing.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    <script>
        // Format card number with spaces
        document.getElementById('CardNumber').addEventListener('input', function (e) {
            e.target.value = e.target.value.replace(/\D/g, '');
        });

        // Format expiry date
        document.getElementById('ExpiryDate').addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2);
            }
            e.target.value = value;
        });

        // Format CVV
        document.getElementById('CVV').addEventListener('input', function (e) {
            e.target.value = e.target.value.replace(/\D/g, '');
        });
    </script>
}
